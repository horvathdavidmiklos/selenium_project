var FINANCIAL_ACCURACY=1e-6,FINANCIAL_MAX_ITERATIONS=100,FINANCIAL_SECS_PER_DAY=86400,FINANCIAL_HALF_SEC=.5/FINANCIAL_SECS_PER_DAY;function PV(r,n,t,u,l){u||(u=0),l||(l=0);var a=calculate_pvif(r,n),$=calculate_fvifa(r,n);if(0==a)return null;var e=(-u-t*(1+r*l)*$)/a;return isFinite(e)?e:null}function FV(r,n,t,u,l){u||(e=0),l||(l=0);var a=calculate_pvif(r,n),$=calculate_fvifa(r,n),e=-(u*a+t*(1+r*l)*$);return isFinite(e)?e:null}function PMT(r,n,t,u,l){u||(u=0),l||(l=0);var a=calculate_pmt(r,n,t,u,l);return isFinite(a)?a:null}function IPMT(r,n,t,u,l,a){if(l||(l=0),a||(a=0),n<1||n>=t+1)return null;var $=calculate_pmt(r,t,u,l,a),e=calculate_interest_part(u,$,r,n-1);return isFinite(e)?e:null}function PPMT(r,n,t,u,l,a){if(l||(l=0),a||(a=0),n<1||n>=t+1)return null;var $=calculate_pmt(r,t,u,l,a),e=calculate_interest_part(u,$,r,n-1);return isFinite($)&&isFinite(e)?$-e:null}function calculate_fvifa(r,n){return 0==r?n:(Math.pow(1+r,n)-1)/r}function calculate_pvif(r,n){return Math.pow(1+r,n)}function calculate_interest_part(r,n,t,u){return-(r*Math.pow(1+t,u)*t+n*(Math.pow(1+t,u)-1))}function calculate_pmt(r,n,t,u,l){var a=calculate_pvif(r,n),$=calculate_fvifa(r,n);return(-t*a-u)/((1+r*l)*$)}function NPV(r,n){if(!is_array(n))return null;for(var t=0,u=0;u<n.length;u++)t+=n[u]/Math.pow(1+r,u+1);return isFinite(t)?t:null}function IRR2(r,n){for(var t,u,l,a=[],$=!1,e=!1,c=0;c<r.length;c++)a[c]=0===c?0:a[c-1]+365,r[c]>0&&($=!0),r[c]<0&&(e=!0);if(!$||!e)return"#NUM!";var n=void 0===n?.1:n,f=n,i=0,_=!0;do l=function(r,n,t){for(var u=t+1,l=r[0],a=1;a<r.length;a++)l+=r[a]/Math.pow(u,(n[a]-n[0])/365);return l}(r,a,f),u=Math.abs((t=f-l/function(r,n,t){for(var u=t+1,l=0,a=1;a<r.length;a++){var $=(n[a]-n[0])/365;l-=$*r[a]/Math.pow(u,$+1)}return l}(r,a,f))-f),f=t,_=u>1e-10&&Math.abs(l)>1e-10;while(_&&++i<50);return _?"#NUM!":f}function IRR(r,n){if(!is_array(r))return null;n||(n=.1);for(var t=0,u=n,l=NPV(t,r),a=NPV(u,r),$=0;$<FINANCIAL_MAX_ITERATIONS&&!(l*a<0);$++)Math.abs(l)<Math.abs(a)?l=NPV(t+=1.6*(t-u),r):a=NPV(u+=1.6*(u-t),r);if(l*a>0)return null;var e=null,c=null;0>NPV(t,r)?(e=t,c=u-t):(e=u,c=t-u);for(var f=null,i=null,$=0;$<FINANCIAL_MAX_ITERATIONS;$++){var f=e+(c*=.5),i=NPV(f,r);if(i<=0&&(e=f),Math.abs(i)<FINANCIAL_ACCURACY||Math.abs(c)<FINANCIAL_ACCURACY)return f}return null}function is_array(r){return"object"==typeof r&&r instanceof Array}